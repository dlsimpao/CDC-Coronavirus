---
title: "Classification - Final Project"
author: 'Falak Shah (SID: 914663151)'
date: "5/23/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(timeDate)
library(ggplot2)
library(plotly)
library(hrbrthemes)
#install.packages("hrbrthemes")
#install.packages("tseries")
library(tseries)
#install.packages("ggmap")
library(ggmap)
library(mltools)
library(data.table)
library(caret)
#install.packages("faux")
library(faux)
#install.packages("DataExplorer")
library(DataExplorer)
#install.packages('e1071', dependencies=TRUE)
library(e1071)

```

```{r}

cdc_classifiction = read.csv("C:/Users/Falak/Desktop/Spring Quarter '21/STA 160/CDC_classification.csv")

cdc_classifiction[,c(1,2,4,7:10,15:63)] <- lapply(cdc_classifiction[,c(1,2,4,7:10,15:63)], as.factor)

## 75% of the sample size
smp_size <- floor(0.75 * nrow(cdc_classifiction))

## set the seed to make your partition reproducible
set.seed(123)
train_ind <- sample(seq_len(nrow(cdc_classifiction)), size = smp_size)

train_data <- cdc_classifiction[train_ind, ]
test_data <- cdc_classifiction[-train_ind, ]

head(cdc_classifiction)

```


# Hospitality - Logistic

```{r}
control <- rfeControl(functions = lmFuncs , # random forest
                      method = "repeatedcv", # repeated cv
                      repeats = 5, # number of repeats
                      verbose = FALSE) # number of folds


x_train = train_data[,15:62]
y_train = train_data[,7]

result_rfe1 <- rfe(x = x_train, 
                   y = y_train, 
                   sizes = c(1:ncol(x_train)),
                   rfeControl = control)



```
