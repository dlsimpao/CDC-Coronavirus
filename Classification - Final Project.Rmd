
```{r}
library(tidyverse)
library(timeDate)
library(ggplot2)
library(plotly)
library(hrbrthemes)
#install.packages("hrbrthemes")
#install.packages("tseries")
library(tseries)
#install.packages("ggmap")
library(ggmap)
library(mltools)
library(data.table)
library(caret)
#install.packages("faux")
library(faux)
#install.packages("DataExplorer")
library(DataExplorer)
#install.packages('e1071', dependencies=TRUE)
library(e1071)

```

```{r}

cdc_classification = read.csv('cdc_filtered_encoded.csv')
cdc_classification = cdc_classification[,2:32]
cdc_classification[,c(1,2,4,7:31)] = lapply(cdc_classification[,c(1,2,4,7:31)],factor) 
## 75% of the sample size
smp_size <- floor(0.75 * nrow(cdc_classification))
## set the seed to make your partition reproducible
set.seed(123)
train_ind <- sample(seq_len(nrow(cdc_classification)), size = smp_size)
train_data <- cdc_classification[train_ind, ]
test_data <- cdc_classification[-train_ind, ]
#head(cdc_classification)


```


# Hospitality - Logistic

```{r}
control <- rfeControl(functions = lmFuncs , # random forest
                      method = "repeatedcv", # repeated cv
                      repeats = 5, # number of repeats
                      verbose = FALSE) # number of folds


names(train_data)
#classes
# [8] "hosp_yn"                   
#  [9] "icu_yn"                    [10] "death_yn"
# [15] "mechvent_yn"

# Health worker not included
# [11] "hc_work_yn"

#predictor features of interest
# [12] "pna_yn"                    
# [13] "abxchest_yn"                "acuterespdistress_yn"      
# [16] "fever_yn"                  
# [17] "sfever_yn"                  "chills_yn"                 
# [19] "myalgia_yn"                 "runnose_yn"                
# [21] "sthroat_yn"                 "cough_yn"                  
# [23] "sob_yn"                     "nauseavomit_yn"            
# [25] "headache_yn"                "abdom_yn"                  
# [27] "diarrhea_yn"                "medcond_yn"


#x_train = train_data[,15:62]
x_train = train_data[,c(12:14,16:28)]
# hosp_yn index
y_train = train_data[,8]

result_rfe1 <- rfe(x = x_train, 
                   y = y_train, 
                   sizes = c(1:2),
                   rfeControl = control)



```
